import{gsap as e,Draggable as t,Flip as r,InertiaPlugin as a,SlowMo as o,RoughEase as n}from"./external/greensock/all.js";import s from"./utilities.js";import c from"./constants.js";import i from"./tarot-deck.js";import l from"./tarot-card.js";e.t(t,r,a,o,n),Object.entries({o:()=>{$("#over-layer *").off("click mouseenter");const t=e.timeline();return t.to("#over-layer",{scale:2,opacity:0,i:"expo.out",duration:2.5,l(){$("#over-layer *").remove(),e.set("#over-layer",{scale:1,opacity:1})}},0),t.to(".canvas-layer:not(#over-layer)",{scale:1,duration:3,i:"expo.out"},0),t},u:()=>{const t=e.timeline();return t.p("#reading-section",{h:45},{h:0,duration:6,i:"sine"}),t.to("#blackout-layer",{opacity:0,duration:6,m:45,i:"sine"},0),t.to(".canvas-layer:not(#control-layer):not(#blackout-layer)",{scale:1,opacity:1,m:45,duration:6,i:"sine"},0),t}}).forEach((([t,r])=>e.k({name:t,effect:r})));const u={g:!1,v:[],T:!1,j:c.$.O,C:!0,get F(){return this.C?c.$.C:this.j},set F(e){this.j=e},S:{1:{U:!1,X:!1,Z:c.I[1],P:!1,H:!1,N:!1},2:{U:!1,X:!1,Z:c.I[2],P:!1,H:!1,N:!1},3:{U:!1,X:!1,Z:c.I[3],P:!1,H:!1,N:!1},4:{U:!1,X:!1,Z:c.I[4],P:!1,H:!1,N:!1},5:{U:!1,X:!1,Z:c.I[5],P:!1,H:!1,N:!1}},get A(){return[1,2,3,4,5].find((e=>this.S[e].U&&!1===this.S[e].P))},get D(){return[1,2,3,4,5].find((e=>!1===this.S[e].U))},get G(){return Object.values(this.S).map((({U:e})=>e))}},d=(e,t)=>{if(e=e in c.$?c.$[e]:e,Object.values(c.F).includes(e))switch(u.F=e,console.log(`*** SWITCHING PHASE TO: ${e}`),e){case c.$.L:return y();case c.$.M:return h(t);default:return!0}return!1},p=()=>{},y=()=>{u.C=!0;e.timeline().p("#reading-section",{h:65},{h:0,duration:6,i:"sine"}).to("#blackout-layer",{opacity:0,duration:6,m:45,i:"sine"},0).to(".canvas-layer:not(#control-layer):not(#blackout-layer)",{scale:1,opacity:1,m:45,duration:6,i:"sine"},0).then((()=>{$("#blackout-layer").remove(),u.C=!1}))},h=({g:e})=>{u.C=!0,u.g=e,console.log("Starting Orbit"),console.log(u),u.g.R()},m=()=>{$(".canvas-layer *").remove(),0===$("#blackout-layer").length&&$('<div id="blackout-layer"></div>').prependTo("body"),e.set("#blackout-layer, .canvas-layer",{W:-50,_:-50,x:c.I[1].x,y:c.I[1].y,z(e,t){switch(t.id){case"blackout-layer":return 500;case"background-layer":return c.B.q-2;case"under-layer":return c.B.q-1;case"card-layer":return c.B.q;case"over-layer":return c.B.q+c.B.J;case"control-layer":return c.B.q+2*c.B.J;default:return 0}},m:80,K:!0});Object.keys(c.V);const t=Object.keys(c.V).map((e=>new i(e,u))),[r,a]=s.Y(t,((e,r)=>r<=Math.ceil(t.length/2)-1)),o=(e.ee("#card-layer","width")-c.U.width*r.length-c.spacing.x*(r.length-1))/2,n=(e.ee("#card-layer","width")-c.U.width*a.length-c.spacing.x*(a.length-1))/2;r.forEach(((e,t)=>{e.x=o+.5*c.U.width+t*(c.spacing.x+c.U.width),e.y=Number(c.U.height),u.v.push(e),e.te(1)})),a.forEach(((e,t)=>{e.x=n+.5*c.U.width+t*(c.spacing.x+c.U.width),e.y=2.5*c.U.height,u.v.push(e),e.te(2)}))},b=()=>{i.re(),l.re(),y()};m(),$(document).ready(b);export{m as InitializeDomElements,b as Initialize,u as SessionData,d as SetPhase,p as Update};