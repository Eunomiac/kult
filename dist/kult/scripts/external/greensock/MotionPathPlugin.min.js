/*!
 * MotionPathPlugin 3.5.1
 * https://greensock.com
 *
 * @license Copyright 2008-2020, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/
import{getRawPath as t,cacheRawPathMeasurements as n,getPositionOnPath as r,pointsToSegment as i,flatPointsToSegment as o,sliceRawPath as e,stringToRawPath as a,rawPathToString as u,transformRawPath as s,convertToPath as h}from"./utils/paths.js";import{getGlobalMatrix as f}from"./utils/matrix.js";var c,g,P,l,p=["x","translateX","left","marginLeft"],x=["y","translateY","top","marginTop"],v=Math.PI/180,y=function(t,n,r,i){for(var o=n.length,e=2===i?0:i,a=0;a<o;a++)t[e]=parseFloat(n[a][r]),2===i&&(t[e+1]=0),e+=2;return t},d=function(t,n,r){return parseFloat(t.t.get(t,n,r||"px"))||0},m=function(t){var n,r=t[0],i=t[1];for(n=2;n<t.length;n+=2)r=t[n]+=r,i=t[n+1]+=i},w=function(t,r,e,a,u,s,h){"cubic"===h.type?r=[r]:(r.unshift(d(e,a,h.i),u?d(e,u,h.o):0),h.u&&m(r),r=[(u?i:o)(r,h.h)]);return r=s(j(r,e,h)),F(t,e,a,r,"x",h.i),u&&F(t,e,u,r,"y",h.o),n(r,h.g||(0===h.h?20:12))},M=function(t){return t},R=/[-+\.]*\d+[\.e\-\+]*\d*[e\-\+]*\d*/g,T=function(t,n,r){var i,o,e,a=f(t);return"svg"===(t.tagName+"").toLowerCase()?(o=(i=t.viewBox.baseVal).x,e=i.y,i.width||(i={width:+t.getAttribute("width"),height:+t.getAttribute("height")})):(i=n&&t.getBBox&&t.getBBox(),o=e=0),n&&"auto"!==n&&(o+=n.push?n[0]*(i?i.width:t.offsetWidth||0):n.x,e+=n.push?n[1]*(i?i.height:t.offsetHeight||0):n.y),r.apply(o||e?a.apply({x:o,y:e}):{x:a.e,y:a.f})},b=function(t,n,r,i){var o,e=f(t.parentNode,!0,!0),a=e.clone().multiply(f(n)),u=T(t,r,e),s=T(n,i,e),h=s.x,c=s.y;return a.e=a.f=0,"auto"===i&&n.getTotalLength&&"path"===n.tagName.toLowerCase()&&(o=n.getAttribute("d").match(R)||[],h+=(o=a.apply({x:+o[0],y:+o[1]})).x,c+=o.y),(o||n.getBBox&&t.getBBox&&n.ownerSVGElement===t.ownerSVGElement)&&(h-=(o=a.apply(n.getBBox())).x,c-=o.y),a.e=h-u.x,a.f=c-u.y,a},j=function(n,r,i){var o,e,a,u=i.align,h=i.matrix,f=i.offsetX,g=i.offsetY,P=i.P,p=n[0][0],x=n[0][1],v=d(r,"x"),y=d(r,"y");return n&&n.length?(u&&("self"===u||(o=l(u)[0]||r)===r?s(n,1,0,0,1,v-p,y-x):(P&&!1!==P[2]?c.set(r,{transformOrigin:100*P[0]+"% "+100*P[1]+"%"}):P=[d(r,"xPercent")/-100,d(r,"yPercent")/-100],a=(e=b(r,o,P,"auto")).apply({x:p,y:x}),s(n,e.a,e.b,e.c,e.d,v+e.e-(a.x-e.e),y+e.f-(a.y-e.f)))),h?s(n,h.a,h.b,h.c,h.d,h.e,h.f):(f||g)&&s(n,1,0,0,1,f||0,g||0),n):t("M0,0L0,0")},F=function(t,n,r,i,o,e){var a=n.t,u=a.l,s=u&&u.p&&u.p[r],h=s&&s.indexOf(",")<0?s:r,f=t.v=new g(t.v,n,h,0,0,M,0,a.set(n,h,t));f.m=P(a.get(n,h,e))||0,f.path=i,f.M=o,t.R.push(h)};export var MotionPathPlugin={version:"3.5.1",name:"motionPath",register:function(t,n,r){P=(c=t).j.T,l=c.j.toArray,g=r},init:function(r,i){if(!c)return console.warn("Please gsap.registerPlugin(MotionPathPlugin)"),!1;"object"==typeof i&&!i.style&&i.path||(i={path:i});var o,a,u,s,h,f,g=[],l=i.path,v=l[0],d=i.F,m=(h=i.start,f="end"in i?i.end:1,function(t){return h||1!==f?e(t,h,f):t});if(this.L=g,this.target=r,(this.rotate=d||0===d)&&(this.A=parseFloat(d)||0,this.O=!!i.S,this.C=i.rotation||"rotation",this.G=r.t.set(r,this.C,this),this.X=P(r.t.get(r,this.C))||0),Array.isArray(l)&&!("closed"in l)&&"number"!=typeof v){for(a in v)~p.indexOf(a)?u=a:~x.indexOf(a)&&(s=a);for(a in u&&s?g.push(w(this,y(y([],l,u,0),l,s,1),r,i.x||u,i.y||s,m,i)):u=s=0,v)a!==u&&a!==s&&g.push(w(this,y([],l,a,2),r,a,0,m,i))}else o=m(j(t(i.path),r,i)),n(o,i.g),g.push(o),F(this,r,i.x||"x",o,"x",i.i||"px"),F(this,r,i.y||"y",o,"y",i.o||"px")},Y:function(t,n){var i=n.L,o=i.length,e=n.v;for(t>1?t=1:t<0&&(t=0);o--;)r(i[o],t,!o&&n.rotate,i[o]);for(;e;)e.set(e.k,e.q,e.path[e.M]+e.m,e.d,t),e=e.B;n.rotate&&n.G(n.target,n.C,i[0].angle*(n.O?v:1)+n.A+n.X,n,t)},D:function(r){return n(t(r)).H},I:e,J:t,K:i,N:a,U:u,V:s,W:f,Z:r,$:n,_:function(t,n){return l(t).map((function(t){return h(t,!1!==n)}))},tt:function(t,n,r){var i=f(n,!0,!0).multiply(f(t));return r?i.apply(r):i},nt:b,rt:function(t,n,r,i){var o=b(t,n,r,i);return{x:o.e,y:o.f}},it:function(t,n){var r=y(y([],t,(n=n||{}).x||"x",0),t,n.y||"y",1);return n.u&&m(r),["cubic"===n.type?r:i(r,n.h)]}};(c||"undefined"!=typeof window&&(c=window.gsap)&&c.ot&&c)&&c.ot(MotionPathPlugin);export{MotionPathPlugin as default};