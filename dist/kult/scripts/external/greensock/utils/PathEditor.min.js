/*!
 * PathEditor 3.5.1
 * https://greensock.com
 *
 * Copyright 2008-2020, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/
import{stringToRawPath as t,rawPathToString as i,bezierToPoints as s,simplifyPoints as h,pointsToSegment as n,subdivideSegment as o,getClosestData as r,copyRawPath as e,transformRawPath as a}from"./paths.js";import{getGlobalMatrix as f,Matrix2D as u}from"./matrix.js";var c,l,d,v,p,m,k,M,g,w,P,E,D,C=/(?:(-)?\d*\.?\d*(?:e[\-+]?\d+)?)[0-9]/gi,S=Math.PI/180,b=Date.now||function(){return(new Date).getTime()},x=0,R=0,y=function(){return!1},W={},X=[],z={},N=[],A=[],j=function(t){t.preventDefault&&(t.preventDefault(),t.t&&t.t())},G=function(t){return c.createElementNS?c.createElementNS("http://www.w3.org/1999/xhtml",t):c.createElement(t)},U=function(t,i,s){var h,n=c.createElementNS("http://www.w3.org/2000/svg",t),o=/([a-z])([A-Z])/g;for(h in(s=s||{}).i=s.i||"path-editor",s)void 0!==n.style[h]?n.style[h]=s[h]:n.setAttributeNS(null,h.replace(o,"$1-$2").toLowerCase(),s[h]);return i.appendChild(n),n},V={matrix:new u},$=function(t){return(t.transform&&t.transform.baseVal.consolidate()||V).matrix},_=function(t){return~~(1e3*t+(t<0?-.5:.5))/1e3},q=function(t){if(!t.target.h&&!R&&b()-x>100){for(var i=A.length;--i>-1;)A[i].o();A.length=0}},B=0,I=function(t,i,s,h){if(t.addEventListener){var n=P[i];h=h||{passive:!1},t.addEventListener(n||i,s,h),n&&i!==n&&"pointer"!==n.substr(0,7)&&t.addEventListener(i,s,h)}else t.attachEvent&&t.attachEvent("on"+i,s)},Z=function(t,i,s){if(t.removeEventListener){var h=P[i];t.removeEventListener(h||i,s),h&&i!==h&&"pointer"!==h.substr(0,7)&&t.removeEventListener(i,s)}else t.detachEvent&&t.detachEvent("on"+i,s)},F=function t(i){B=i.touches&&_dragCount<i.touches.length,Z(i.target,"touchend",t)},H=function(t){B=t.touches&&_dragCount<t.touches.length,I(t.target,"touchend",F)},J=function(t,i){return function(s){return t.call(i,s)}},K=function(t,i,s){var h=i.u[t];return h&&h.call(i.u.l||i,s||i),i},L=function(){E.style.display="block",E.select(),E.style.display="none"},O=function(t){var i,s,h=this,n=f(h.target.parentNode,!0);this.v=this.target.transform.baseVal.getItem(0).matrix,this.p=n,P[t.type]?(i=-1!==t.type.indexOf("touch")?t.currentTarget||t.target:c,I(i,"touchend",h.m),I(i,"touchmove",h.k),I(i,"touchcancel",h.m),I(c,"touchstart",H),I(d,"touchforcechange",j)):(i=null,I(c,"mousemove",h.k)),l||I(c,"mouseup",h.m),j(t),L(),t.changedTouches?(t=h.M=t.changedTouches[0],h.g=t.identifier):t.pointerId?h.g=t.pointerId:h.M=h.g=null,h.P=h.D=t.pageY,h.C=h.S=t.pageX,h.R=h.v.e,h.W=h.v.f,1===this.p.a&&0===this.p.b&&0===this.p.c&&1===this.p.d?this.p=null:(s=h.C*this.p.a+h.P*this.p.c+this.p.e,h.P=h.C*this.p.b+h.P*this.p.d+this.p.f,h.C=s),h.X=R=!0,h.N=i,h.u.A&&h.u.A.call(h.u.l||h,h.j)},Q=function(t){var i,s,h=this,n=t;if(h.G&&!B&&h.X&&t){if(h.j=t,i=t.changedTouches){if((t=i[0])!==h.M&&t.identifier!==h.g){for(s=i.length;--s>-1&&(t=i[s]).identifier!==h.g;);if(s<0)return}}else if(t.pointerId&&h.g&&t.pointerId!==h.g)return;j(n),h.U(t.pageX,t.pageY),h.u.V&&h.u.V.call(h.u.l||h,h.j)}},T=function(t,i){var s=this;if(s.G&&s.X&&(!t||null==s.g||i||!(t.pointerId&&t.pointerId!==s.g||t.changedTouches&&!function(t,i){for(var s=t.length;--s>-1;)if(t[s].identifier===i)return!0;return!1}(t.changedTouches,s.g)))){x=b(),s.X=R=!1;var h,n,o=t,r=s.$,e=s.N;if(e?(Z(e,"touchend",s.m),Z(e,"touchmove",s.k),Z(e,"touchcancel",s.m),Z(c,"touchstart",H)):Z(c,"mousemove",s.k),l||(Z(c,"mouseup",s.m),t&&t.target&&Z(t.target,"mouseup",s.m)),r?s.$=!1:s.u._&&s.u._.call(s.u.l||s,o),t){if((h=t.changedTouches)&&(t=h[0])!==s.M&&t.identifier!==s.g){for(n=h.length;--n>-1&&(t=h[n]).identifier!==s.g;);if(n<0)return}s.j=o,s.S=t.pageX,s.D=t.pageY}return o&&!r&&s.u.q?s.u.q.call(s,s.j):(o&&j(o),s.u.B&&s.u.B.call(s.u.l||s,s.j)),r&&s.u.I&&s.u.I.call(s.u.l||s,s.j),!0}},Y=function(t,i,s,h){var n,o=t[i].length,r=[];for(n=0;n<o;n+=6)r.push(new st(s,t,i,n,h));return r},tt=function(t,i,s){var h=t[s]-t[i],n=t[s+1]-t[i+1];return Math.sqrt(h*h+n*n)},it=function(){function t(t,i){this.target="string"==typeof t?c.querySelectorAll(t)[0]:t,this.u=i||{},this.Z=J(O,this),this.k=J(Q,this),this.m=J(T,this),this.target.setAttribute("transform",(this.target.getAttribute("transform")||"")+" translate(0,0)"),this.v=$(this.target),this.x=this.v.e,this.y=this.v.f,this.F=i.F,isNaN(i.H)&&isNaN(i.J)?this.K=0:(this.K=1,this.H=+i.H,this.J=+i.J),this.enabled(!0)}var i=t.prototype;return i.U=function(t,i){var s,h,n,o,r,e=1e3;this.S=t,this.D=i,this.p&&(r=t*this.p.a+i*this.p.c+this.p.e,i=t*this.p.b+i*this.p.d+this.p.f,t=r),(h=i-this.P)<1&&h>-1&&(h=0),(s=t-this.C)<1&&s>-1&&(s=0),n=((this.R+s)*e|0)/e,o=((this.W+h)*e|0)/e,this.F&&!k&&(z.x=n,z.y=o,this.F.call(this,z),n=z.x,o=z.y),this.x===n&&this.y===o||(this.v.f=this.y=o,this.v.e=this.x=n,!this.$&&this.X&&(this.$=!0,K("onDragStart",this,this.j)))},i.enabled=function(t){return arguments.length?(this.G=t,t?(l||I(this.target,"mousedown",this.Z),I(this.target,"touchstart",this.Z),I(this.target,"click",this.L,!0)):(i=this.$,Z(this.target,"mousedown",this.Z),Z(this.target,"touchstart",this.Z),Z(d,"touchforcechange",j),Z(this.target,"click",this.L),this.N&&(Z(this.N,"touchcancel",this.m),Z(this.N,"touchend",this.m),Z(this.N,"touchmove",this.k)),Z(c,"mouseup",this.m),Z(c,"mousemove",this.k),this.$=this.X=!1,i&&K("onDragEnd",this,this.j)),this):this.G;var i},i.O=function(t){this.m(t)},t}(),st=function(){function t(t,i,s,h,n){this.T=t,this.element=U("path",t.Y,{fill:"#4e7fff",stroke:"#4e7fff",strokeWidth:2,vectorEffect:"non-scaling-stroke"}),this.update(i,s,h),this.element.h=!0,this.u=n||{},this.tt=new it(this.element,{l:this,V:this.V,F:this.u.F,A:this.A,B:this.B,_:this._,I:this.I})}var i=t.prototype;return i.A=function(){K("onPress",this)},i._=function(){K("onClick",this)},i.V=function(){var t=this.it;this.u.V.call(this.u.l||this,this,this.tt.x-t[this.st],this.tt.y-t[this.st+1])},i.I=function(){K("onDragEnd",this)},i.B=function(){K("onRelease",this)},i.update=function(t,i,s){t&&(this.ht=t),arguments.length<=1?(i=this.nt,s=this.st):(this.nt=i,this.st=s);var h=this.smooth,n=this.ht[i];this.it=n,this.smooth=s&&s<n.length-2&&Math.abs(Math.atan2(n[s+1]-n[s-1],n[s]-n[s-2])-Math.atan2(n[s+3]-n[s+1],n[s+2]-n[s]))<.09?2:0,this.smooth!==h&&this.element.setAttribute("d",this.smooth?this.T.ot:this.T.rt),this.element.setAttribute("transform","translate("+n[s]+","+n[s+1]+")")},t}();export var PathEditor=function(){function h(t,i){i=i||{},D||(c=document,d=window,v=c.body,w=G("div"),(E=G("textarea")).style.display="none",v&&v.appendChild(E),P=function(t){for(var i=t.split(","),s=(void 0!==w.onpointerdown?"pointerdown,pointermove,pointerup,pointercancel":void 0!==w.onmspointerdown?"MSPointerDown,MSPointerMove,MSPointerUp,MSPointerCancel":t).split(","),h={},n=4;--n>-1;)h[i[n]]=s[n],h[s[n]]=i[n];return h}("touchstart,touchmove,touchend,touchcancel"),SVGElement.prototype.getTransformToElement=SVGElement.prototype.getTransformToElement||function(t){return t.getScreenCTM().inverse().multiply(this.getScreenCTM())},c.addEventListener("keydown",(function(t){var i,s,h,n,o=t.keyCode||t.which,r=t.key||o;if("Shift"===r||16===o)k=!0;else if("Control"===r||17===o)p=!0;else if("Meta"===r||91===o)M=!0;else if("Alt"===r||18===o)for(m=!0,i=A.length;--i>-1;)A[i].et();else if(("z"===r||90===o)&&(p||M)&&X.length>1){if(X.shift(),s=X[0]){for((n=s.path).path.setAttribute("d",s.d),n.path.setAttribute("transform",s.transform),n.init(),h=n.ft,i=0;i<h.length;i++)-1!==s.ut.indexOf(h[i].st)&&n.ct.push(h[i]);n.lt(),n.update(),n.u.dt&&n.u.dt.call(n)}}else if("Delete"===r||"Backspace"===r||8===o||46===o||63272===o||"d"===o&&(p||M))for(i=A.length;--i>-1;)A[i].vt();else if(("a"===r||65===o)&&(M||p))for(i=A.length;--i>-1;)A[i].select(!0)}),!0),c.addEventListener("keyup",(function(t){var i=t.key||t.keyCode||t.which;if("Shift"===i||16===i)k=!1;else if("Control"===i||17===i)p=!1;else if("Meta"===i||91===i)M=!1;else if("Alt"===i||18===i){m=!1;for(var s=A.length;--s>-1;)A[s].kt()}}),!0),l=!!d.PointerEvent,I(c,"mouseup",q),I(c,"touchend",q),I(c,"touchcancel",y),I(d,"touchmove",y),v&&v.addEventListener("touchstart",y),D=1),this.u=i,this.path="string"==typeof t?c.querySelectorAll(t)[0]:t,this.Mt=U("g",this.path.ownerSVGElement,{i:"path-editor-g path-editor"}),this.gt=U("path",this.Mt,{stroke:"transparent",strokeWidth:16,fill:"none",vectorEffect:"non-scaling-stroke"}),this.Y=i.Y||U("g",this.Mt,{i:"path-editor-selection path-editor"}),this.wt=U("path",this.Y,{stroke:"#4e7fff",strokeWidth:2,fill:"none",vectorEffect:"non-scaling-stroke"}),this.ct=[],this.Pt=U("polyline",this.Y,{stroke:"#4e7fff",strokeWidth:2,vectorEffect:"non-scaling-stroke"}),this.Et=U("polyline",this.Y,{stroke:"#4e7fff",strokeWidth:2,vectorEffect:"non-scaling-stroke"}),this.Pt.style.pointerEvents=this.Et.style.pointerEvents=this.wt.style.pointerEvents="none",this.G=!0;var s=this.path.parentNode.getScreenCTM().inverse(),h=(s.a+s.d)/2*(i.Dt||5);this.rt=function(t){return["M-"+(t=_(t)),-t,t,-t,t,t,-t,t+"z"].join(",")}(h),this.ot=function(t){var i=_(.552284749831*t);return"M"+(t=_(t))+",0C"+[t,i,i,t,0,t,-i,t,-t,i,-t,0,-t,-i,-i,-t,0,-t,i,-t,t,-i,t,0].join(",")+"z"}(1.15*h),this.Ct=U("path",this.Y,{d:this.rt,fill:"#4e7fff",stroke:"transparent",strokeWidth:6}),this.St=U("path",this.Y,{d:this.rt,fill:"#4e7fff",stroke:"transparent",strokeWidth:6}),this.Ct.tt=new it(this.Ct,{V:this.bt,l:this,A:this.xt,B:this.Rt,_:this.yt,F:i.Wt}),this.St.tt=new it(this.St,{V:this.Xt,l:this,A:this.zt,B:this.Rt,_:this.Nt,F:i.Wt}),this.Ct.style.visibility=this.St.style.visibility="hidden";for(var n=[this.Ct,this.St,this.Pt,this.Et,this.Y,this.wt,this.gt],o=n.length;--o>-1;)n[o].h=!0;!1!==i.draggable&&(this.tt=new it(this.gt,{l:this,A:this.select,B:this.m,V:this.At,I:this.jt,H:this.u.H,J:this.u.J})),this.init(),this.Y.style.visibility=!1===i.selected?"hidden":"visible",!1!==i.selected&&(this.path.h=!0,A.push(this)),this.jt(),l||(I(this.gt,"mousedown",J(this.Gt,this)),I(this.gt,"mouseup",J(this.m,this))),I(this.gt,"touchstart",J(this.Gt,this)),I(this.gt,"touchend",J(this.m,this))}var n=h.prototype;return n.m=function(t){var i=this.Ut;i&&(W.x=i.it[i.st],W.y=i.it[i.st+1]),Z(d,"touchforcechange",j),K("onRelease",this,t)},n.init=function(){var i,s,h=this.path.getAttribute("d"),n=t(h),o=this.path.getAttribute("transform")||"translate(0,0)",r=!this.Vt||n.$t!==this.Vt.$t||n.length!==this.Vt.length,e={l:this,F:this.u._t,V:this.qt,A:this.Bt,B:this.m,_:this.It,I:this.Zt,H:this.u.H,J:this.u.J};if(r&&this.ft&&this.ft.length){for(s=0;s<this.ft.length;s++)this.ft[s].element.parentNode.removeChild(this.ft[s].element),this.ft[s].tt.enabled(!1);this.ct.length=0}if(this.Vt=n,r){if(this.ft=Y(n,0,this,e),(i=n.length)>1)for(s=1;s<i;s++)this.ft=this.ft.concat(Y(n,s,this,e))}else for(s=this.ft.length;--s>-1;)this.ft[s].update(n);return this.Y.appendChild(this.Ct),this.Y.appendChild(this.St),this.wt.setAttribute("d",h),this.gt.setAttribute("d",h),this.Mt.setAttribute("transform",function(t){for(var i=$(t),s=t.ownerSVGElement;(t=t.parentNode)&&t.ownerSVGElement===s;)i.multiply($(t));return"matrix("+i.a+","+i.b+","+i.c+","+i.d+","+i.e+","+i.f+")"}(this.path.parentNode)||"translate(0,0)"),this.Y.setAttribute("transform",o),this.gt.setAttribute("transform",o),this.lt(),this},n.jt=function(){!function(t){var i,s=[],h=t.ct;for(i=0;i<h.length;i++)s[i]=h[i].st;X.unshift({path:t,d:t.path.getAttribute("d"),transform:t.path.getAttribute("transform")||"",ut:s}),X.length>30&&(X.length=30)}(this)},n.Gt=function(t){if("hidden"===this.Y.style.visibility)this.select();else if(m||t&&t.altKey){var i,s,h,n,e,a,f={l:this,F:this.u._t,V:this.qt,A:this.Bt,B:this.m,_:this.It,I:this.Zt,H:this.u.H,J:this.u.J},u=this.Y.getScreenCTM().inverse();for(this.tt&&this.tt.m(t),u&&(n=t.clientX*u.a+t.clientY*u.c+u.e,e=t.clientX*u.b+t.clientY*u.d+u.f),a=r(this.Vt,n,e),o(this.Vt[a.nt],a.st,a.Ft),i=a.st+6,s=0;s<this.ft.length;s++)this.ft[s].st>=i&&(this.ft[s].st+=6);h=new st(this,this.Vt,a.nt,i,f),this.Y.appendChild(this.Ct),this.Y.appendChild(this.St),h.tt.Z(t),g=h,this.ft.push(h),this.ct.length=0,this.ct.push(h),this.lt(),this.update(),this.jt()}L(),I(d,"touchforcechange",j),K("onPress",this)},n.yt=function(){var t=this.Ut,i=t.st,s=t.it;m&&Math.abs(s[i]-s[i-2])<5&&Math.abs(s[i+1]-s[i-1])<5&&this.It(t)},n.Nt=function(){var t=this.Ut,i=t.st,s=t.it;m&&Math.abs(s[i]-s[i+2])<5&&Math.abs(s[i+1]-s[i+3])<5&&this.It(t)},n.Zt=function(t){g=null,this.jt()},n.Ht=function(){return this.ct.length>0},n.select=function(t){if(this.Y.style.visibility="visible",this.Ut=null,this.path.h=!0,!0===t)for(var i=this.ft.length;--i>-1;)this.ct[i]=this.ft[i];return-1===A.indexOf(this)&&A.push(this),this.lt(),this},n.o=function(){return this.Y.style.visibility="hidden",this.ct.length=0,this.Ut=null,this.path.h=!1,A.splice(A.indexOf(this),1),this.lt(),this},n.At=function(t){var i=this.gt.getAttribute("transform")||"translate(0,0)";this.Y.setAttribute("transform",i),this.path.setAttribute("transform",i)},n.Bt=function(t){-1===this.ct.indexOf(t)?(k||(this.ct.length=0),this.ct.push(t)):k&&(this.ct.splice(this.ct.indexOf(t),1),t.tt.O()),W.x=t.it[t.st],W.y=t.it[t.st+1],this.lt(),K("onPress",this)},n.vt=function(){for(var t,i,s,h=this.ct,n=h.length;--n>-1;)for((t=h[n]).element.parentNode.removeChild(t.element),t.tt.enabled(!1),(i=t.st)?i<t.it.length-2?t.it.splice(i-2,6):t.it.splice(i-4,6):t.it.splice(i,6),h.splice(n,1),this.ft.splice(this.ft.indexOf(t),1),s=0;s<this.ft.length;s++)this.ft[s].st>=i&&(this.ft[s].st-=6);this.lt(),this.update(),this.jt(),this.u.Jt&&this.u.Jt.call(this.u.l||this)},n.It=function(t){var i,s,h,n,o,r,e=t.st,a=t.it,f=1e3,u=!e||e>=a.length-2;m&&g!==t&&this.Ut?(t.smooth=!t.smooth,u&&(t.smooth=!1),t.element.setAttribute("d",t.smooth?this.ot:this.rt),t.smooth&&!u?(i=((i=Math.atan2(a[e+1]-a[e-1],a[e]-a[e-2]))+(s=Math.atan2(a[e+3]-a[e+1],a[e+2]-a[e])))/2,h=tt(a,e-2,e),n=tt(a,e,e+2),h<.2&&(h=tt(a,e,e-6)/4,i=s||Math.atan2(a[e+7]-a[e-5],a[e+6]-a[e-6])),n<.2&&(n=tt(a,e,e+6)/4,s=i||Math.atan2(a[e+7]-a[e-5],a[e+6]-a[e-6])),o=Math.sin(i),r=Math.cos(i),Math.abs(s-i)<Math.PI/2&&(o=-o,r=-r),a[e-2]=((a[e]+r*h)*f|0)/f,a[e-1]=((a[e+1]+o*h)*f|0)/f,a[e+2]=((a[e]-r*n)*f|0)/f,a[e+3]=((a[e+1]-o*n)*f|0)/f,this.lt(),this.update(),this.jt()):t.smooth||u||(e&&(a[e-2]=a[e],a[e-1]=a[e+1]),e<a.length-2&&(a[e+2]=a[e],a[e+3]=a[e+1]),this.lt(),this.update(),this.jt())):k||(this.ct.length=0,this.ct.push(t)),g=null,this.lt()},n.lt=function(){var t,i,s,h=1===this.ct.length?this.ct[0]:null,n=h?h.it:null;for(this.Ut=h,t=0;t<this.ft.length;t++)this.ft[t].element.style.fill=-1!==this.ct.indexOf(this.ft[t])?"#4e7fff":"white";h&&(this.Ct.setAttribute("d",h.smooth?this.ot:this.rt),this.St.setAttribute("d",h.smooth?this.ot:this.rt)),t=h?h.st:0,h&&t?(i=n[t-2],s=n[t-1],this.Ct.style.visibility=this.Pt.style.visibility=m||i!==n[t]||s!==n[t+1]?"visible":"hidden",this.Ct.setAttribute("transform","translate("+i+","+s+")"),this.Pt.setAttribute("points",i+","+s+","+n[t]+","+n[t+1])):this.Ct.style.visibility=this.Pt.style.visibility="hidden",h&&t<n.length-2?(i=n[t+2],s=n[t+3],this.St.style.visibility=this.Et.style.visibility=m||i!==n[t]||s!==n[t+1]?"visible":"hidden",this.St.setAttribute("transform","translate("+i+","+s+")"),this.Et.setAttribute("points",n[t]+","+n[t+1]+","+i+","+s)):this.St.style.visibility=this.Et.style.visibility="hidden"},n.et=function(){var t=this.Ut;t&&(t.st&&(this.Ct.style.visibility=this.Pt.style.visibility="visible"),t.st<t.it.length-2&&(this.St.style.visibility=this.Et.style.visibility="visible"))},n.kt=function(){var t,i,s=this.Ut;s&&((t=s.it)[i=s.st]===t[i-2]&&t[i+1]===t[i-1]&&(this.Ct.style.visibility=this.Pt.style.visibility="hidden"),t[i]===t[i+2]&&t[i+1]===t[i+3]&&(this.St.style.visibility=this.Et.style.visibility="hidden"))},n.xt=function(){this.Ut.smooth&&(this.Kt=tt(this.Ut.it,this.Ut.st,this.Ut.st+2)),K("onPress",this)},n.zt=function(){this.Ut.smooth&&(this.Kt=tt(this.Ut.it,this.Ut.st-2,this.Ut.st)),K("onPress",this)},n.Rt=function(t){this.m(t),this.jt()},n.bt=function(){var t,i=this.Ut,s=i.it,h=i.st,n=1e3,o=this.Ct.tt.x,r=this.Ct.tt.y;s[h-2]=o=(o*n|0)/n,s[h-1]=r=(r*n|0)/n,i.smooth&&(m?(i.smooth=!1,i.element.setAttribute("d",this.rt),this.Ct.setAttribute("d",this.rt),this.St.setAttribute("d",this.rt)):(t=Math.atan2(s[h+1]-r,s[h]-o),o=this.Kt*Math.cos(t),r=this.Kt*Math.sin(t),s[h+2]=((s[h]+o)*n|0)/n,s[h+3]=((s[h+1]+r)*n|0)/n)),this.update()},n.Xt=function(){var t,i=this.Ut,s=i.it,h=i.st,n=1e3,o=this.St.tt.x,r=this.St.tt.y;s[h+2]=o=(o*n|0)/n,s[h+3]=r=(r*n|0)/n,i.smooth&&(m?(i.smooth=!1,i.element.setAttribute("d",this.rt),this.Ct.setAttribute("d",this.rt),this.St.setAttribute("d",this.rt)):(t=Math.atan2(s[h+1]-r,s[h]-o),o=this.Kt*Math.cos(t),r=this.Kt*Math.sin(t),s[h-2]=((s[h]+o)*n|0)/n,s[h-1]=((s[h+1]+r)*n|0)/n)),this.update()},n.qt=function(t,i,s){var h,n,o,r,e=this.ct,a=e.length,f=1e3;for(n=0;n<a;n++)h=(r=e[n]).st,o=r.it,h&&(o[h-2]=((o[h-2]+i)*f|0)/f,o[h-1]=((o[h-1]+s)*f|0)/f),o[h]=((o[h]+i)*f|0)/f,o[h+1]=((o[h+1]+s)*f|0)/f,h<o.length-2&&(o[h+2]=((o[h+2]+i)*f|0)/f,o[h+3]=((o[h+3]+s)*f|0)/f),r!==t&&r.element.setAttribute("transform","translate("+o[h]+","+o[h+1]+")");this.update()},n.enabled=function(t){if(!arguments.length)return this.G;for(var i=this.ft.length;--i>-1;)this.ft[i].tt.enabled(t);return this.G=t,this.Ct.tt.enabled(t),this.St.tt.enabled(t),this.tt&&this.tt.enabled(t),t?this.Y.parentNode||(this.path.ownerSVGElement.appendChild(this.gt),this.path.ownerSVGElement.appendChild(this.Y),this.init(),this.jt()):(this.o(),this.path.ownerSVGElement.removeChild(this.gt),this.path.ownerSVGElement.removeChild(this.Y)),this.lt(),this.update()},n.update=function(t){var i,s,h,n,o="",r=this.Ut;if(t&&this.init(),r&&(i=r.st,s=r.it,i&&(h=s[i-2],n=s[i-1],this.Ct.setAttribute("transform","translate("+h+","+n+")"),this.Pt.setAttribute("points",h+","+n+","+s[i]+","+s[i+1])),i<s.length-2&&(h=s[i+2],n=s[i+3],this.St.setAttribute("transform","translate("+h+","+n+")"),this.Et.setAttribute("points",s[i]+","+s[i+1]+","+h+","+n))),t)o=this.path.getAttribute("d");else{for(i=0;i<this.Vt.length;i++)(s=this.Vt[i]).length>7&&(o+="M"+s[0]+","+s[1]+"C"+s.slice(2).join(","));this.path.setAttribute("d",o),this.wt.setAttribute("d",o),this.gt.setAttribute("d",o)}return this.u.Lt&&this.G&&K("onUpdate",this,o),this},n.Ot=function(t,i,s){if(t){var h=$(this.path);return a(e(this.Vt),1,0,0,1,h.e+(i||0),h.f+(s||0))}return this.Vt},n.Qt=function(t,s,h){if(t){var n=$(this.path);return i(a(e(this.Vt),1,0,0,1,n.e+(s||0),n.f+(h||0)))}return this.path.getAttribute("d")},n.Tt=function(t,i,h,n){var o,r,e,a,f,u,c=this.Vt[0],l=-1*c[0],d=0===i?0:-(i||c[1]),v=c.length,p=1/(c[v-2]+l),m=-t||c[v-1]+d,k=1e3;for(N.length=0,m=m?1/m:-p,p*=k,m*=k,r=0;r<v;r+=2)N[r]=((c[r]+l)*p|0)/k,N[r+1]=((c[r+1]+d)*m|0)/k;if(n){for(o=[],v=N.length,r=2;r<v;r+=6)e=N[r-2],a=N[r-1],f=N[r+4],u=N[r+5],o.push(e,a,f,u),s(e,a,N[r],N[r+1],N[r+2],N[r+3],f,u,.001,o,o.length-2);for(e=o[0],v=o.length,r=2;r<v;r+=2){if((f=o[r])<e||f>1||f<0){n();break}e=f}}return h&&8===v&&0===N[0]&&0===N[1]&&1===N[v-2]&&1===N[v-1]?N.slice(2,6).join(","):(N[2]="C"+N[2],"M"+N.join(","))},h}();PathEditor.Yt=h,PathEditor.ti=n,PathEditor.ii=function(i,o){var r,e,a,f,u,l,d,v,p,m,k,M;if(m=(o=o||{}).si||1,p=o.precision||1/m,M=(void 0===o.hi?18:+o.hi)*S,"string"!=typeof i&&(i=(r=i).getAttribute("d")),"#"!==i.charAt(0)&&"."!==i.charAt(0)||(r=c.querySelector(i))&&(i=r.getAttribute("d")),e=!1!==o.ni||/[achqstvz]/gi.test(i)?t(i)[0]:i.match(C),!1!==o.ni){for(v=e,e=[],k=v.length,a=2;a<k;a+=6)f=+v[a-2],l=+v[a-1],u=+v[a+4],d=+v[a+5],e.push(_(f),_(l),_(u),_(d)),s(f,l,+v[a],+v[a+1],+v[a+2],+v[a+3],u,d,1/(2e5*p),e,e.length-2);(e=n(h(e,m),o.oi,M))[2]="C"+e[2]}else e=h(e,m);return i="M"+e.join(","),r&&r.setAttribute("d",i),i},PathEditor.create=function(t,i){return new PathEditor(t,i)},PathEditor.ri=W,PathEditor.ei=function(t){var i=t.ai||2,s=1e20,h=t.x||0===t.x?t.x:t.width?0:-s,n=t.y||0===t.y?t.y:t.height?0:-s,o=h+(t.width||s*s),r=n+(t.height||s*s),e=!1!==t.fi,a=!1!==t.ui,f=t.axis,u=t.ci;return i*=i,function(t){var s,c,l,d,v=t.x,p=t.y;e&&v<h||(l=v-h)*l<i?v=h:(e&&v>o||(l=o-v)*l<i)&&(v=o),a&&p<n||(d=p-n)*d<i?p=n:(a&&p>r||(d=r-p)*d<i)&&(p=r),f&&(l=v-f.x,d=p-f.y,l*l<i&&(v=f.x),d*d<i&&(p=f.y)),u&&(l=(s=h+Math.round((v-h)/u)*u)-v)*l+(d=(c=n+Math.round((p-n)/u)*u)-p)*d<i&&(v=s,p=c),t.x=v,t.y=p}},PathEditor.version="3.5.1";export{PathEditor as default};